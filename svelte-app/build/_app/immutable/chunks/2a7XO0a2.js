var N=Object.defineProperty;var w=s=>{throw TypeError(s)};var U=(s,e,t)=>e in s?N(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var M=(s,e,t)=>U(s,typeof e!="symbol"?e+"":e,t),x=(s,e,t)=>e.has(s)||w("Cannot "+t);var i=(s,e,t)=>(x(s,e,"read from private field"),t?t.call(s):e.get(s)),l=(s,e,t)=>e.has(s)?w("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(s):e.set(s,t),D=(s,e,t,r)=>(x(s,e,"write to private field"),r?r.call(s,t):e.set(s,t),t);import{f as S,g as j,i as y,p as q,j as A,k as B,h as z,l as C,m as E,n as I,o as F,q as O,t as T,u as $,v as G,x as H,y as J,z as K}from"./BAGG94wi.js";var c,u,f,d,p,_,m;class Q{constructor(e,t=!0){M(this,"anchor");l(this,c,new Map);l(this,u,new Map);l(this,f,new Map);l(this,d,new Set);l(this,p,!0);l(this,_,()=>{var e=S;if(i(this,c).has(e)){var t=i(this,c).get(e),r=i(this,u).get(t);if(r)j(r),i(this,d).delete(t);else{var a=i(this,f).get(t);a&&(i(this,u).set(t,a.effect),i(this,f).delete(t),a.fragment.lastChild.remove(),this.anchor.before(a.fragment),r=a.effect)}for(const[n,o]of i(this,c)){if(i(this,c).delete(n),n===e)break;const h=i(this,f).get(o);h&&(y(h.effect),i(this,f).delete(o))}for(const[n,o]of i(this,u)){if(n===t||i(this,d).has(n))continue;const h=()=>{if(Array.from(i(this,c).values()).includes(n)){var g=document.createDocumentFragment();E(o,g),g.append(A()),i(this,f).set(n,{effect:o,fragment:g})}else y(o);i(this,d).delete(n),i(this,u).delete(n)};i(this,p)||!r?(i(this,d).add(n),q(o,h,!1)):h()}}});l(this,m,e=>{i(this,c).delete(e);const t=Array.from(i(this,c).values());for(const[r,a]of i(this,f))t.includes(r)||(y(a.effect),i(this,f).delete(r))});this.anchor=e,D(this,p,t)}ensure(e,t){var r=S,a=I();if(t&&!i(this,u).has(e)&&!i(this,f).has(e))if(a){var n=document.createDocumentFragment(),o=A();n.append(o),i(this,f).set(e,{effect:B(()=>t(o)),fragment:n})}else i(this,u).set(e,B(()=>t(this.anchor)));if(i(this,c).set(r,e),a){for(const[h,b]of i(this,u))h===e?r.unskip_effect(b):r.skip_effect(b);for(const[h,b]of i(this,f))h===e?r.unskip_effect(b.effect):r.skip_effect(b.effect);r.oncommit(i(this,_)),r.ondiscard(i(this,m))}else z&&(this.anchor=C),i(this,_).call(this)}}c=new WeakMap,u=new WeakMap,f=new WeakMap,d=new WeakMap,p=new WeakMap,_=new WeakMap,m=new WeakMap;let v=!1,k=Symbol();function R(s,e,t){const r=t[e]??(t[e]={store:null,source:O(void 0),unsubscribe:F});if(r.store!==s&&!(k in t))if(r.unsubscribe(),r.store=s??null,s==null)r.source.v=void 0,r.unsubscribe=F;else{var a=!0;r.unsubscribe=T(s,n=>{a?r.source.v=n:J(r.source,n)}),a=!1}return s&&k in t?$(s):G(r.source)}function V(){const s={};function e(){H(()=>{for(var t in s)s[t].unsubscribe();K(s,k,{enumerable:!1,value:!0})})}return[s,e]}function W(s){var e=v;try{return v=!1,[s(),v]}finally{v=e}}export{Q as B,V as a,W as c,R as s};
